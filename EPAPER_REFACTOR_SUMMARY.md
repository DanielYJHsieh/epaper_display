# E-Paper 顯示器程式重構總結

## 重構基礎
基於 IC 廠商 A32-GDEQ0426T82 的參考程式碼進行完整重構。

## 主要改動

### 1. 硬體控制層面
- **基於廠商程式碼**: 完全採用 A32-GDEQ0426T82 的初始化和控制流程
- **腳位適配**: 將原廠商的 A14-A17 腳位適配為 ESP8266 的 D2-D8 腳位
- **SPI 設定**: 採用廠商推薦的 10MHz SPI 頻率設定
- **巨集定義**: 使用廠商程式碼的腳位控制巨集風格

### 2. 初始化函數
```cpp
- EPD_HW_Init()        // 完整螢幕更新初始化
- EPD_HW_Init_Fast()   // 快速更新初始化  
- EPD_HW_Init_180()    // 180度旋轉初始化
```

### 3. 顯示控制函數
```cpp
- EPD_WhiteScreen_ALL()       // 完整螢幕顯示
- EPD_WhiteScreen_ALL_Fast()  // 快速螢幕顯示
- EPD_WhiteScreen_White()     // 清除螢幕 (白色)
- EPD_WhiteScreen_Black()     // 顯示全黑
- EPD_SetRAMValue_BaseMap()   // 部分更新基礎地圖
```

### 4. 更新控制函數
```cpp
- EPD_Update()         // 完整更新 (0xF7)
- EPD_Update_Fast()    // 快速更新 (0xC7)  
- EPD_Part_Update()    // 部分更新 (0xFF)
```

### 5. 通訊函數
```cpp
- SPI_Write()           // SPI 寫入
- EPD_W21_WriteCMD()    // 發送命令
- EPD_W21_WriteDATA()   // 發送資料
- Epaper_READBUSY()     // 等待忙碌信號
```

## 序列埠指令功能

### 基本指令
- `help` (h) - 顯示說明
- `status` (s) - 系統狀態
- `clear` (c) - 清空螢幕 (完整更新)
- `sleep` - 進入深度睡眠
- `reset` (r) - 重新啟動

### 顯示指令
- `test` (t) - 測試圖案 (完整更新)
- `fast` (f) - 快速更新示範
- `black` (b) - 全黑螢幕
- `180` - 180度旋轉顯示
- `demo` (d) - 完整示範流程
- `text <內容>` - 自訂文字顯示

## 技術規格

### 硬體參數
- **解析度**: 480x800 像素 (基於廠商規格)
- **記憶體**: 48KB 緩衝區 (480×800÷8)
- **SPI 頻率**: 10MHz (廠商推薦)
- **更新時間**: 
  - 完整更新: ~2 秒
  - 快速更新: ~1.5 秒
  - 部分更新: <1 秒

### 腳位對應 (ESP8266)
```
廠商程式碼    ESP8266      功能
A14          D2 (GPIO4)    BUSY
A15          D4 (GPIO2)    RST  
A16          D3 (GPIO0)    DC
A17          D8 (GPIO15)   CS
SCLK         D5 (GPIO14)   SCK
MOSI         D7 (GPIO13)   DIN
```

### 控制暫存器 (SSD1677)
- 0x01 - 驅動輸出控制
- 0x0C - 升壓軟啟動控制
- 0x11 - 資料輸入模式
- 0x18 - 溫度感測器控制
- 0x22 - 顯示更新控制
- 0x24 - 寫入 RAM
- 0x44/0x45 - RAM 位址設定
- 0x4E/0x4F - RAM 位址計數器

## 改進項目

### 相容性
- ✅ 完全基於廠商程式碼
- ✅ 保留所有廠商推薦的初始化流程
- ✅ ESP8266 腳位適配
- ✅ 溫度控制和邊界控制

### 功能性
- ✅ 完整/快速/部分更新支援
- ✅ 180度旋轉支援
- ✅ 序列埠指令控制
- ✅ 緩衝區管理
- ✅ 基本繪圖功能

### 穩定性
- ✅ 廠商驗證的控制流程
- ✅ 適當的延遲和等待
- ✅ 超時檢查
- ✅ 錯誤處理

## 使用方式

### 啟動後自動示範
1. 完整更新 - 清空螢幕
2. 完整更新 - 顯示測試圖案
3. 快速更新 - 顯示歡迎圖案

### 序列埠控制
```
Serial Monitor (115200 baud):
> help          // 查看所有指令
> test          // 顯示測試圖案
> fast          // 快速更新示範
> clear         // 清空螢幕
> demo          // 完整示範流程
```

## 作者資訊
- **作者**: DYJ Hsieh
- **版本**: v2.0
- **基礎**: A32-GDEQ0426T82 廠商參考程式碼
- **日期**: 2025年7月

## 檔案更新
- ✅ epaper_display.ino - 主程式完全重構
- ✅ 所有函數基於廠商程式碼
- ✅ 腳位定義適配 ESP8266
- ✅ 保留用戶友好的序列埠介面
