# 電池供電系統接線圖

本檔案提供詳細的電路圖與接線示意圖，方便實際組裝。

---

## 🔌 完整系統接線圖

### 方式 A: 文字描述（適用麵包板）

```
USB 充電器 (5V)
    │
    ├─ VCC → TP4056 IN+
    └─ GND → TP4056 IN-
    
TP4056 模組
    │
    ├─ B+  ─┬─ 18650 電池正極
    │       └─ 分壓電路起點
    ├─ B-  ─── 18650 電池負極
    │
    ├─ OUT+ ──> MT3608 IN+
    ├─ OUT- ──> MT3608 IN- (共地)
    │
    ├─ CHRG  ──> ESP8266 GPIO14 (D5)
    └─ STDBY ──> ESP8266 GPIO12 (D6)

MT3608 升壓模組
    │
    ├─ OUT+ (5V) ──> ESP8266 5V 腳位
    └─ OUT- (GND) ──> ESP8266 GND

分壓電路（電量偵測）
    TP4056 OUT+ ─┬─ R1 (100kΩ) ─┬─ R2 (33kΩ) ─┬─ GND
                 │                │             │
                 │                └─> ESP8266 A0 (ADC)
                 │                              │
                 └──────────────────────────────┘

Deep Sleep 喚醒（重要！）
    ESP8266 GPIO16 (D0) ─── ESP8266 RST
    (需用杜邦線短接)
```

---

## 📐 ASCII 藝術接線圖

```
                    ┌──────────────┐
                    │ USB 充電器   │
                    │   5V / 2A    │
                    └───┬──────┬───┘
                        │      │
                       VCC    GND
                        │      │
              ┌─────────┴──────┴─────────┐
              │    TP4056 充電模組        │
              │   (含 DW01A 保護板)      │
              │                          │
              │  IN+            OUT+  ───┼──┬──> MT3608 IN+
              │   │               │      │  │
              │  IN-            OUT-  ───┼──┼──> MT3608 IN- (GND)
              │   │               │      │  │
              │  B+              CHRG ───┼──┼──> GPIO14 (D5)
              │   │                      │  │
              │  B-             STDBY ───┼──┼──> GPIO12 (D6)
              │   │                      │  │
              └───┼──────────────────────┘  │
                  │                         │
          ┌───────┴────────┐                │
          │  18650 電池    │                │
          │  3.7V 2600mAh  │                │
          │                │                │
          │   ┌─────┐      │                │
          │   │ (+) │──────┼────────────────┘
          │   └─────┘      │                │
          │   ┌─────┐      │                │
          │   │ (-) │──────┼────────────────┐
          │   └─────┘      │                │
          └────────────────┘                │
                                            │
          ┌─────────────────────────────────┘
          │
          │  分壓電路（電量偵測）
          │
          │  TP4056 OUT+ ─┬─ 100kΩ ─┬─ 33kΩ ─┬─ GND
          │               │          │        │
          │               │          └────────┼──> A0
          │               │                   │
          │               └───────────────────┘
          │
          │
          ├─────────────────────────────────┐
          │      MT3608 升壓模組            │
          │      (調整至 5V 輸出)           │
          │                                 │
          │  IN+  ────────────────────────> 來自 TP4056 OUT+
          │  IN-  ────────────────────────> GND
          │                                 │
          │  OUT+ (5V) ──────────────────>  ESP8266 5V
          │  OUT- (GND) ─────────────────>  ESP8266 GND
          │                                 │
          └─────────────────────────────────┘
          
          
          ┌─────────────────────────────────┐
          │       ESP8266 (WeMos D1 Mini)   │
          │                                 │
          │  5V   ◄──────────────────────── MT3608 OUT+ (5V)
          │  GND  ◄──────────────────────── 共地
          │  A0   ◄──────────────────────── 分壓電路輸出
          │  D5   ◄──────────────────────── TP4056 CHRG
          │  D6   ◄──────────────────────── TP4056 STDBY
          │  D0   ◄──┐                      
          │  RST  ◄──┘ (杜邦線短接)         
          │                                 │
          │  D7   ──> E-Paper CLK           │
          │  D8   ──> E-Paper DIN (MOSI)    │
          │  ... (其他顯示腳位)             │
          │                                 │
          └─────────────────────────────────┘
```

---

## 🧩 麵包板佈局建議

```
麵包板佈局（俯視圖）

   [+5V 電源軌]
   ════════════════════════════════════════

    TP4056         MT3608         ESP8266
   ┌──────┐       ┌──────┐       ┌──────┐
   │ OUT+ │───────│ IN+  │       │      │
   │      │       │      │───────│ 5V   │
   │ OUT- │─┬─────│ IN-  │   ┌───│ GND  │
   └──────┘ │     │      │   │   │      │
            │     │ OUT+ │───┘   │ A0   │◄── 分壓電路
            │     │ OUT- │───┐   │      │
            │     └──────┘   │   │ D5   │◄── CHRG
            │                │   │ D6   │◄── STDBY
            │                │   │ D0   │◄─┐
            │                │   │ RST  │◄─┘ 短接
            │                │   └──────┘
            │                │
   ══════════════════════════════════════════
   [GND 地線軌] ◄──────────────┘
   
   電池放置於麵包板旁（用電池座固定）
   分壓電阻可插在麵包板空位
```

---

## 📋 接線檢查清單

完成接線後，按順序檢查：

### 步驟 1: 電源部分
- [ ] 18650 電池極性正確（正極 → B+，負極 → B-）
- [ ] USB 充電器連接 TP4056 IN+/IN-
- [ ] TP4056 紅燈亮起（充電中）

### 步驟 2: 升壓模組
- [ ] TP4056 OUT+ 連接 MT3608 IN+
- [ ] TP4056 OUT- 連接 MT3608 IN-
- [ ] 用萬用表測量 MT3608 OUT+ 與 OUT-，確認為 **5.0V ±0.1V**

### 步驟 3: ESP8266 供電
- [ ] MT3608 OUT+ (5V) 連接 ESP8266 5V 腳位
- [ ] MT3608 OUT- (GND) 連接 ESP8266 GND
- [ ] ESP8266 板載 LED 應閃爍（正常開機）

### 步驟 4: 分壓電路
- [ ] TP4056 OUT+ 連接 100kΩ 電阻一端
- [ ] 100kΩ 電阻另一端連接 33kΩ 電阻與 A0
- [ ] 33kΩ 電阻另一端連接 GND
- [ ] 用萬用表測量 A0 與 GND 間電壓，應為 **~0.9V**（電池 3.7V 時）

### 步驟 5: 充電狀態檢測（可選）
- [ ] TP4056 CHRG 連接 GPIO14 (D5)
- [ ] TP4056 STDBY 連接 GPIO12 (D6)

### 步驟 6: Deep Sleep 喚醒（重要！）
- [ ] GPIO16 (D0) 用杜邦線短接到 RST
- [ ] 確認連線牢固（Deep Sleep 喚醒的關鍵）

---

## ⚠️ 安全注意事項

### 🔥 防止短路
- 接線前先關閉所有電源
- 確認極性（尤其是電池！）
- 避免金屬工具碰觸帶電部分

### 🔋 電池安全
- 使用有保護板的電池或 TP4056 含保護板版本
- 避免過度充放電（< 2.5V 或 > 4.3V）
- 充電時注意溫度（< 60°C）

### 🌡️ 散熱
- TP4056 充電時會發熱，確保通風
- MT3608 長時間大電流會發熱（一般無問題）
- ESP8266 WiFi 傳輸時會發熱（正常現象）

### 🔌 USB 充電
- 使用 5V/2A 充電器（品質佳）
- 避免使用電腦 USB（電流可能不足）
- 充電線使用數據線，非純充電線

---

## 🔧 調試技巧

### 電壓測量點

| 測量點 | 預期電壓 | 備註 |
|--------|---------|------|
| 電池 B+ 與 B- | 3.0-4.2V | 電池電壓 |
| TP4056 OUT+ 與 OUT- | 同電池電壓 | 保護板通過 |
| MT3608 OUT+ 與 OUT- | 5.0V ±0.1V | 升壓輸出 |
| ESP8266 3.3V 腳位與 GND | 3.3V ±0.1V | 板載 LDO |
| A0 與 GND | 0.68-1.04V | ADC 輸入 |

### 常見接線錯誤

| 錯誤現象 | 可能原因 | 解決方法 |
|---------|---------|---------|
| ESP8266 不開機 | 供電不足或極性錯誤 | 檢查 MT3608 輸出 5V |
| 充電紅燈不亮 | USB 未連接或 TP4056 損壞 | 更換充電器或模組 |
| ADC 讀值為 0 | 分壓電路未連接 | 檢查 A0 與電阻連接 |
| Deep Sleep 不喚醒 | D0 未連接 RST | 用杜邦線短接 |

---

## 📸 接線照片參考（範例）

> **建議**: 組裝完成後拍照記錄，方便日後維護或分享。

拍攝重點：
1. 整體佈局（俯視圖）
2. TP4056 與電池連接
3. MT3608 與 ESP8266 連接
4. 分壓電路細節
5. D0 與 RST 短接

---

## 🎓 進階優化

### PCB 整合版（未來規劃）

若要製作 PCB，建議佈局：
```
頂層：
  - TP4056 區域（左側）
  - MT3608 區域（中央）
  - ESP8266 區域（右側）
  - 分壓電阻（靠近 ESP8266）

底層：
  - 大面積敷銅作為地線
  - 電池座焊盤

```

### 線材選擇
- **電源線** (5V/3.3V): 20-22 AWG（較粗，降低壓降）
- **訊號線** (GPIO): 24-26 AWG（較細，節省空間）

---

**版本**: 1.0  
**撰寫日期**: 2025-10-12  
**維護**: battery_management 專案團隊
