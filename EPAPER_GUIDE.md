# 📱 ESP8266 E-Paper 顯示器專案

## 🎯 專案概述

這個專案使用 ESP8266 控制 GDEQ0426T82 E-Paper 顯示器，提供完整的圖形顯示功能。

### 🔧 硬體規格

- **顯示器型號**：GDEQ0426T82
- **驅動IC**：SSD1677
- **尺寸**：7.5 吋
- **解析度**：800x480 像素
- **顏色**：黑白雙色
- **介面**：SPI
- **工作電壓**：3.3V

## 🔌 硬體連接

### ESP8266 ↔ E-Paper 連接表

| E-Paper 腳位 | ESP8266 腳位 | GPIO | 功能說明 |
|-------------|-------------|------|----------|
| VCC         | 3.3V        | -    | 電源正極 |
| GND         | GND         | -    | 電源負極 |
| DIN (MOSI)  | D7          | GPIO13 | SPI 資料輸入 |
| CLK (SCK)   | D5          | GPIO14 | SPI 時脈 |
| CS          | D8          | GPIO15 | 晶片選擇 |
| DC          | D3          | GPIO0  | 資料/命令選擇 |
| RST         | D4          | GPIO2  | 重置信號 |
| BUSY        | D2          | GPIO4  | 忙碌狀態 |

### 🔗 連接圖

```
ESP8266 NodeMCU         GDEQ0426T82
┌─────────────┐         ┌─────────────┐
│    3.3V     │────────▶│     VCC     │
│    GND      │────────▶│     GND     │
│ D7 (GPIO13) │────────▶│  DIN (MOSI) │
│ D5 (GPIO14) │────────▶│  CLK (SCK)  │
│ D8 (GPIO15) │────────▶│     CS      │
│ D3 (GPIO0)  │────────▶│     DC      │
│ D4 (GPIO2)  │────────▶│     RST     │
│ D2 (GPIO4)  │◀────────│    BUSY     │
└─────────────┘         └─────────────┘
```

## ⚡ 快速開始

### 1. 硬體準備

1. **ESP8266 開發板** (NodeMCU 或 Wemos D1 Mini)
2. **GDEQ0426T82 E-Paper 顯示器**
3. **杜邦線** (公對母)
4. **麵包板** (可選)

### 2. 軟體安裝

1. 確保 Arduino IDE 已安裝 ESP8266 開發板支援
2. 載入 `epaper_display/epaper_display.ino` 程式
3. 選擇正確的開發板和連接埠
4. 編譯並上傳程式

### 3. 測試運行

1. **開啟序列埠監控視窗** (115200 鮑率)
2. **重置 ESP8266** 查看初始化訊息
3. **輸入指令** 測試顯示功能

## 🎮 序列埠指令

### 基本指令

| 指令 | 功能 | 範例 |
|------|------|------|
| `help` 或 `h` | 顯示說明 | `help` |
| `status` 或 `s` | 顯示系統狀態 | `status` |
| `clear` 或 `c` | 清空顯示器 | `clear` |

### 顯示指令

| 指令 | 功能 | 範例 |
|------|------|------|
| `test` 或 `t` | 顯示測試圖案 | `test` |
| `welcome` 或 `w` | 顯示歡迎訊息 | `welcome` |
| `info` 或 `i` | 顯示系統資訊 | `info` |
| `text <內容>` | 顯示自訂文字 | `text Hello World` |

### 系統指令

| 指令 | 功能 | 範例 |
|------|------|------|
| `sleep` | 進入深度睡眠 | `sleep` |
| `reset` 或 `r` | 重新啟動 | `reset` |

## 🎨 功能特色

### ✅ 已實現功能

- ✅ **SSD1677 驅動程式**：完整的暫存器控制
- ✅ **SPI 通訊**：高速資料傳輸
- ✅ **圖形繪製**：點、線、矩形、圓形
- ✅ **文字顯示**：8x8 基本字型、16x16 大字型
- ✅ **影像緩衝**：記憶體管理和快速更新
- ✅ **LUT 控制**：自訂更新波形
- ✅ **深度睡眠**：低功耗模式
- ✅ **序列埠控制**：豐富的指令介面

### 🎯 顯示內容

1. **歡迎畫面**：專案資訊和系統狀態
2. **系統資訊**：CPU、記憶體、WiFi 狀態
3. **測試圖案**：直線、矩形、圓形、棋盤格
4. **自訂文字**：支援英文字母和數字

### 🔧 技術特點

- **非阻塞設計**：使用狀態機避免 delay() 阻塞
- **記憶體優化**：動態分配顯示緩衝區
- **錯誤處理**：完整的超時和狀態檢查
- **模組化設計**：功能分離，易於擴展

## 📊 效能參數

| 項目 | 數值 | 備註 |
|------|------|------|
| **解析度** | 800x480 | 384,000 像素 |
| **緩衝區** | 48,000 bytes | 記憶體佔用 |
| **更新時間** | ~8-15 秒 | 完整畫面更新 |
| **SPI 頻率** | 4 MHz | 資料傳輸速度 |
| **功耗** | < 80mA | 更新時 |
| **待機功耗** | < 1mA | 深度睡眠模式 |

## 🚀 進階應用

### 擴展功能建議

1. **WiFi 整合**
   - 網路時鐘顯示
   - 天氣資訊展示
   - 遠端控制介面

2. **感測器整合**
   - 溫濕度監控
   - 空氣品質顯示
   - 電源電壓監測

3. **資料記錄**
   - SD 卡存儲
   - 雲端上傳
   - 歷史圖表

4. **互動功能**
   - 按鈕控制
   - 觸控面板
   - 聲音回饋

### 🖼️ 影像處理

```cpp
// 顯示點陣圖 (需要轉換工具)
void displayBitmap(const uint8_t* bitmap) {
  memcpy(imageBuffer, bitmap, EPD_BUFFER_SIZE);
  updateDisplay();
}

// 部分更新 (快速刷新)
void partialUpdate(int x, int y, int width, int height) {
  setLUT(lut_partial_update);
  setMemoryArea(x, y, x + width - 1, y + height - 1);
  // ... 更新指定區域
}
```

## 🔍 故障排除

### 常見問題

1. **顯示器無反應**
   - 檢查電源連接 (3.3V，不可用5V)
   - 確認 SPI 連線是否正確
   - 檢查 BUSY 信號線

2. **顯示內容異常**
   - 確認解析度設定正確
   - 檢查記憶體是否足夠
   - 驗證 LUT 設定

3. **更新速度慢**
   - 使用部分更新模式
   - 調整 SPI 頻率
   - 優化 LUT 波形

4. **記憶體不足**
   - 使用動態記憶體分配
   - 分段處理大影像
   - 壓縮影像資料

### 🔧 除錯技巧

```cpp
// 記憶體檢查
Serial.printf("Free Heap: %d bytes\n", ESP.getFreeHeap());

// SPI 通訊測試
digitalRead(EPD_BUSY_PIN);  // 檢查 BUSY 狀態

// 顯示緩衝區檢查
Serial.printf("Buffer Size: %d bytes\n", EPD_BUFFER_SIZE);
```

## 📚 參考資料

### 技術文件

- **SSD1677 資料表**：官方規格文件
- **ESP8266 參考手冊**：腳位定義和功能
- **SPI 協定規範**：通訊介面標準

### 相關連結

- [E-Paper 顯示原理](https://www.waveshare.com/wiki/E-Paper)
- [SSD1677 驅動程式](https://github.com/waveshare/e-Paper)
- [ESP8266 Arduino Core](https://github.com/esp8266/Arduino)

## 📝 版本更新

### v1.0 (2025/07)
- ✅ 基本 SSD1677 驅動程式
- ✅ SPI 通訊實現
- ✅ 圖形繪製功能
- ✅ 文字顯示系統
- ✅ 序列埠控制介面

### 計劃功能 (v1.1)
- 🔄 部分更新優化
- 🔄 中文字型支援
- 🔄 影像壓縮算法
- 🔄 WiFi 控制介面

---

**專案狀態**：✅ 完成基本功能  
**測試狀態**：🔄 需要硬體驗證  
**文件版本**：v1.0  
**更新日期**：2025年7月
