# E-Paper 顯示器除錯指南

## 🔍 系統性除錯流程

當 E-Paper 顯示器無法正常顯示時，請按照以下步驟逐一檢查：

### 📋 第一步：硬體連接檢查

#### 1.1 電源檢查
```
✅ 檢查項目：
- VCC 是否連接到 3.3V (不是 5V!)
- GND 是否正確連接
- 使用萬用電表測量 VCC 和 GND 之間電壓應為 3.3V ±0.1V
```

#### 1.2 SPI 連接檢查
```
腳位對照表：
ESP8266    │  E-Paper  │  GPIO   │  說明
──────────┼───────────┼─────────┼──────────
D5         │  CLK      │  GPIO14 │  SPI 時鐘
D7         │  DIN      │  GPIO13 │  SPI 資料
D8         │  CS       │  GPIO15 │  晶片選擇
D3         │  DC       │  GPIO0  │  資料/命令
D4         │  RST      │  GPIO2  │  重置
D2         │  BUSY     │  GPIO4  │  忙碌狀態
```

#### 1.3 使用萬用電表檢查
```bash
# 檢查連續性 (蜂鳴器模式)
1. ESP8266 D5 ↔ E-Paper CLK
2. ESP8266 D7 ↔ E-Paper DIN  
3. ESP8266 D8 ↔ E-Paper CS
4. ESP8266 D3 ↔ E-Paper DC
5. ESP8266 D4 ↔ E-Paper RST
6. ESP8266 D2 ↔ E-Paper BUSY
7. ESP8266 3V3 ↔ E-Paper VCC
8. ESP8266 GND ↔ E-Paper GND
```

### 📋 第二步：軟體除錯

#### 2.1 序列埠監控
```
1. 開啟序列埠監控器 (115200 baud)
2. 重新啟動 ESP8266
3. 觀察啟動訊息
4. 檢查是否有錯誤訊息
```

#### 2.2 基本功能測試
```
序列埠指令測試：
- help     - 檢查指令系統是否正常
- status   - 檢查初始化狀態
- test     - 嘗試顯示測試圖案
```

#### 2.3 BUSY 信號檢查
```
問題徵象：程式卡在 "等待顯示器就緒"
可能原因：
- BUSY 腳位連接錯誤
- E-Paper 模組故障
- 電源供應不穩定
```

### 📋 第三步：常見問題排除

#### 3.1 完全無顯示
```
可能原因：
1. 電源問題 (最常見)
2. SPI 連接錯誤
3. CS 腳位問題
4. E-Paper 模組故障

檢查順序：
1. 確認 3.3V 電源
2. 檢查 GND 連接
3. 確認 SPI 腳位
4. 測試 CS 信號
```

#### 3.2 部分顯示或花屏
```
可能原因：
1. 時鐘信號問題
2. 資料線接觸不良
3. 電源雜訊
4. LUT 設定錯誤

檢查順序：
1. 降低 SPI 時鐘頻率
2. 檢查杜邦線品質
3. 加入去耦電容
4. 嘗試不同 LUT
```

#### 3.3 程式卡住
```
卡住位置：
- 等待 BUSY 信號：BUSY 腳位問題
- SPI 傳輸：SPI 連接問題  
- 記憶體分配：RAM 不足

解決方法：
1. 檢查 BUSY 連接
2. 降低 SPI 頻率
3. 減少緩衝區大小
```

### 📋 第四步：進階除錯

#### 4.1 使用邏輯分析儀
```
如果有邏輯分析儀，監控：
- SPI CLK 信號
- SPI MOSI 信號  
- CS 信號
- DC 信號
- RST 信號
```

#### 4.2 分段測試
```
1. 只測試 SPI 通訊
2. 只測試顯示器重置
3. 只測試基本初始化
4. 逐步增加功能
```

### 📋 第五步：替代測試方法

#### 5.1 使用簡化程式
```arduino
// 最小測試程式
void setup() {
  Serial.begin(115200);
  pinMode(D4, OUTPUT);  // RST
  
  // 硬體重置測試
  digitalWrite(D4, HIGH);
  delay(200);
  digitalWrite(D4, LOW);
  delay(10);
  digitalWrite(D4, HIGH);
  delay(200);
  
  Serial.println("重置完成");
}
```

#### 5.2 腳位測試
```arduino
// 腳位輸出測試
void loop() {
  digitalWrite(D8, HIGH); delay(100);  // CS
  digitalWrite(D8, LOW);  delay(100);
  
  digitalWrite(D3, HIGH); delay(100);  // DC  
  digitalWrite(D3, LOW);  delay(100);
  
  Serial.println("腳位測試中...");
}
```

### 🔧 建議工具

#### 必要工具
- 萬用電表
- 優質杜邦線
- 麵包板 (可選)

#### 進階工具  
- 邏輯分析儀
- 示波器
- 去耦電容 (0.1μF, 10μF)

### ⚠️ 注意事項

1. **電壓警告**：絕對不要使用 5V 供電
2. **靜電防護**：E-Paper 對靜電敏感
3. **溫度影響**：極端溫度會影響顯示
4. **更新頻率**：不要過於頻繁更新顯示器

### 📞 求助資訊

如果以上步驟都無法解決問題，請提供：
1. 完整的序列埠輸出
2. 硬體連接照片
3. 使用的 E-Paper 型號
4. ESP8266 開發板型號
5. 電源供應方式

---

**作者**：DYJ Hsieh  
**更新**：2025年7月  
**版本**：v1.0
